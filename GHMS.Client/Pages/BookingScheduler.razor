@page "/room-scheduler"
@inject IJSRuntime JS
@using GHMS.Layout
@layout MainLayout



<div id="Scheduler"></div>

@code {
    private string selectedRoom = "All";
    private List<GuestHouse> guestHouses = new();

    protected override async Task OnInitializedAsync()
    {
        var data = await JS.InvokeAsync<string>("localStorage.getItem", "guestHouses");
        if (!string.IsNullOrEmpty(data))
        {
            guestHouses = System.Text.Json.JsonSerializer.Deserialize<List<GuestHouse>>(data) ?? new();
        }
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Ensure JS has loaded
            await JS.InvokeVoidAsync("initScheduler", selectedRoom);
        }
    }

    private async Task OnRoomChange(ChangeEventArgs e)
    {
        selectedRoom = e.Value?.ToString() ?? "All";
        await JS.InvokeVoidAsync("initScheduler", selectedRoom);
    }

    public class GuestHouse
    {
        public Guid Id { get; set; }
        public int RoomId { get; set; }
        public string GuestName { get; set; } = string.Empty;
        public string Location { get; set; } = string.Empty;
        public int MaxOccupancy { get; set; }
        public int FloorNumber { get; set; }
        public string Amenities { get; set; } = string.Empty;
    }
}
